---
alwaysApply: true
---

# Serena MCP Server

**Purpose**: Semantic code understanding with project memory and session persistence

## Triggers

- Symbol operations: rename, extract, move functions/classes
- Project-wide code navigation and exploration
- Multi-language projects requiring LSP integration
- Session lifecycle: `/load`, `/save`, project activation
- Memory-driven development workflows
- Large codebase analysis (>50 files, complex architecture)

## Choose When

- **Over Morphllm**: For symbol operations, not pattern-based edits
- **For semantic understanding**: Symbol references, dependency tracking, LSP integration
- **For session persistence**: Project context, memory management, cross-session learning
- **For large projects**: Multi-language codebases requiring architectural understanding
- **Not for simple edits**: Basic text replacements, style enforcement, bulk operations

## Works Best With

- **Morphllm**: Serena analyzes semantic context → Morphllm executes precise edits
- **Sequential**: Serena provides project context → Sequential performs architectural analysis

## PortalKey Dual-Project Support

### Project Detection & Auto-Activation

**Context Detection Rules:**

- **Go Backend Context**: Root directory, `pkg/`, `cmd/`, `proto/`, `*.go` files → Auto-activate "portalkey-server"
- **Frontend Context**: `frontend/` directory, `*.tsx`, `*.ts` (in frontend) → Auto-activate "portalkey-server-frontend"
- **Mixed Context**: Use intelligent heuristics based on file operations or user preference

**Auto-Activation Triggers:**

- File operations in detected context automatically switch Serena project
- Command execution (`/implement`, `/load`, `/save`) triggers context detection
- Session start analyzes current working directory for appropriate project activation

### Activation Patterns

```
Working on Go files → Auto-activate "portalkey-server"
Working on frontend files → Auto-activate "portalkey-server-frontend"
Mixed context → Use last active project or prompt for clarification
Cross-project operations → Maintain context awareness and switch as needed
```

### Integration with Commands

- **`/load`**: Auto-detect project context and activate appropriate Serena project
- **`/implement`**: Pre-implementation context detection and automatic project switching
- **`/save`**: Project-aware memory persistence with correct project context
- **Task Management**: Session lifecycle with project-aware memory operations

## Examples

```
"rename getUserData function everywhere" → Serena (symbol operation with dependency tracking)
"find all references to this class" → Serena (semantic search and navigation)
"load my project context" → Serena (/load with auto-detection and project activation)
"save my current work session" → Serena (/save with project-aware memory persistence)
"implement user auth API" → Auto-detect Go context → Activate "portalkey-server" → Proceed
"create login component" → Auto-detect frontend context → Activate "portalkey-server-frontend" → Proceed
"update all console.log to logger" → Morphllm (pattern-based replacement)
```
